# Configuración de Amazon EC2: Instancia para tu Aplicación Rails

Ahora vamos a lanzar una instancia de **Amazon EC2 (Elastic Compute Cloud)**. Esta será tu servidor virtual en la nube donde ejecutaremos tu aplicación Ruby on Rails.

## 1. Lanzar una Nueva Instancia EC2

1. **Inicia sesión en la Consola de AWS.**
2. En la barra de búsqueda, escribe **"EC2"** y selecciona el servicio.
3. En el panel de navegación izquierdo, bajo **"Instances"**, haz clic en **"Instances"**.
4. Haz clic en el botón naranja **"Launch instances"** (Lanzar instancias).

## 2. Configurar los Detalles de la Instancia

Aquí te guiaré a través de las opciones clave para configurar tu instancia:

- **Name and tags:**

  - **Name:** Dale un nombre a tu instancia, por ejemplo: `BlogDePruebaAWS-Server`.

- **Application and OS Images (Amazon Machine Image - AMI):**

  - Selecciona un **AMI** que sea adecuado para un servidor Linux. Te recomiendo usar una de las AMI de Ubuntu o Amazon Linux 2023.
    - **Ubuntu Server 22.04 LTS (HVM), SSD Volume Type** (64-bit x86) es una excelente opción por su popularidad y facilidad de uso. Asegúrate de que sea la versión **LTS (Long Term Support)**.
    - **Amazon Linux 2023 AMI** también es una buena alternativa.

- **Instance type:**

  - Para una práctica inicial, una instancia **`t2.micro`** o **`t3.micro`** es suficiente y, lo que es más importante, ¡está dentro del **Nivel Gratuito de AWS (Free Tier)** si tu cuenta es nueva\! Selecciona una de estas.

- **Key pair (login):**

  - Necesitarás un par de claves (Key Pair) para conectarte de forma segura a tu instancia a través de SSH.
  - Si ya tienes uno, selecciónalo. Si no:
    - Haz clic en **"Create new key pair"**.
    - **Key pair name:** Dale un nombre reconocible, como `blogdepruebaaws-key`.
    - **Key pair type:** Deja **RSA**.
    - **Private key file format:** Elige **`.pem`** (para usar con OpenSSH como Putty o terminal de Linux/macOS).
    - Haz clic en **"Create key pair"**.
    - **¡MUY IMPORTANTE\!** El archivo `.pem` se descargará automáticamente en tu computadora. **Guárdalo en un lugar SEGURO y no lo compartas.** Si pierdes este archivo, no podrás conectarte a tu instancia.

- **Network settings:**

  - **Firewall (security groups):** Esta es la configuración de la seguridad de red.
    - Haz clic en **"Create security group"**.
    - **Security group name:** `blogdepruebaaws-sg`.
    - **Description:** `Security group for BlogDePruebaAWS application`.
    - **Inbound security group rules:**
      - Haz clic en **"Add rule"**.
      - **Type:** `SSH` (port 22). **Source type:** `My IP` (para permitir conexiones solo desde tu IP actual, la más segura) o `Anywhere` (para permitir SSH desde cualquier IP, menos seguro pero más flexible si tu IP cambia). Para práctica, `My IP` es preferible.
      - **Add rule** nuevamente.
      - **Type:** `HTTP` (port 80). **Source type:** `Anywhere` (para que tu aplicación web sea accesible desde internet).
      - **Add rule** nuevamente.
      - **Type:** `HTTPS` (port 443). **Source type:** `Anywhere` (para futuras configuraciones de SSL).

- **Configure storage (volumes):**

  - El tamaño del disco por defecto (8 GiB) suele ser suficiente para una aplicación pequeña. Puedes dejarlo así.

- **Advanced details:**

  - Por ahora, puedes dejar la mayoría de las opciones predeterminadas. No necesitamos un `User data` en este punto.

- **Summary:**

  - Revisa la configuración de tu instancia en el resumen lateral.
  - Haz clic en **"Launch instance"**.

## 3. Verificar el Estado de la Instancia

1. Después de unos minutos, la instancia debería pasar del estado `pending` a `running`.
2. Desde la consola EC2, en la lista de instancias, selecciona la tuya.
3. Anota la **"Public IPv4 address"** (Dirección IPv4 pública) y el **"Public IPv4 DNS"**. Estos serán la forma de acceder a tu servidor desde internet.

## 4. Conectarse a la Instancia EC2 (SSH)

Ahora, vamos a conectarnos a tu servidor virtual usando SSH y la clave `.pem` que descargaste.

1. **Abre tu terminal** (Linux/macOS) o usa una herramienta como PuTTY (Windows, si es necesario, convierte el `.pem` a `.ppk` con PuTTYgen).

2. **Asegúrate de que tu clave `.pem` tenga los permisos correctos** (solo lectura para el propietario). Si no lo has hecho, ejecuta:

   ```bash
   chmod 400 /ruta/a/tu/clave/blogdepruebaaws-key.pem
   ```

   (Reemplaza `/ruta/a/tu/clave/` con la ubicación real de tu archivo).

3. Conéctate a tu instancia usando el comando SSH. El usuario por defecto para Ubuntu es `ubuntu`, y para Amazon Linux 2023 es `ec2-user`.

   - **Para Ubuntu:**
     ```bash
     ssh -i /ruta/a/tu/clave/blogdepruebaaws-key.pem ubuntu@TU_DIRECCION_IP_PUBLICA_EC2
     ```
   - **Para Amazon Linux 2023:**
     ```bash
     ssh -i /ruta/a/tu/clave/blogdepruebaaws-key.pem ec2-user@TU_DIRECCION_IP_PUBLICA_EC2
     ```
   - Cuando te pregunte si quieres continuar la conexión, escribe `yes` y presiona Enter.

Si todo va bien, estarás conectado a tu servidor EC2. Verás un prompt como `ubuntu@ip-XXX-XXX-XXX-XXX:~$` o `ec2-user@ip-XXX-XXX-XXX-XXX:~`.
